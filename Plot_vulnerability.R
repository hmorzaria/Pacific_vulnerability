# Hem Nalini Morzaria Luna
# Plot of final vulnerability scores
#based on Jacob et al. 2012 & Morzaria-Luna et al. 2014
#Created July 2015
#Last updated July 2015

#install.packages(c("psych","nFactors","tidyr","pipeR"))
library(psych)
library(nFactors)
library(plyr)
library(reshape)
library(ggplot2)
library(dplyr)
library(gdata)
library(data.table)
library(tidyr)
library(pipeR)
#clean up the space

rm(list=ls())



# USER BLOCK: CHECK AND CHANGE OPTIONS HERE  
#_________________________________________________________________________
#set working directories
#this should match the path where your files directories are stored
#note the "/" go in the opposite direction than in Windows explorer

#working space
analysispath="E:/Archivos/1Archivos/Articulos/En preparacion/Vulnerability_GOC_Pacific/Analysis" #put path

setwd(analysispath)

summary.r = fread("final_scores.csv", header = T)

summary.r$Community = as.factor(summary.r$Community) 
ggplot(summary.r, aes(x=Adaptability, y=Sensitivity, size=Exposure, colour=Community, fill=Community),legend=FALSE) +
  geom_point(shape=21) + 
  scale_x_reverse() +
  scale_size(range = c(4, 14)) +
  scale_fill_manual(values=c("aquamarine3","forestgreen","greenyellow", "dodgerblue", "darkgoldenrod", "darkolivegreen", "coral1","gold2","darkslateblue","firebrick4","darkorange3","darksalmon")) +
  scale_colour_manual(values=c("aquamarine3","forestgreen","greenyellow", "dodgerblue","darkgoldenrod", "darkolivegreen","coral1","gold2","darkslateblue","firebrick4","darkorange3","darksalmon"))



#theme_bw()



# Random graph code
# 
ggplot(summary.r, aes(x=Quanvulnerability, y=Qualvulnerability, colour=Community, fill=Community)) +
  geom_point(stat="identity")
# cbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7", "#CCFF99", "#990000","#FFFF00")
# 
# ggparallel(names(summary.r)[c(1,2,3,4,5,6,7,8,9)], summary.r, weight=1, asp=0.5, text.angle= 15, method="hammock", order=c(0,0)) +
#   theme( legend.position="none") +
#   scale_fill_manual(values=cbPalette) +
#   scale_colour_brewer(palette="Paired", guide="none")
# 
# ggparallel(list("Community", "Poverty"), data=summary.r, method="hammock")
# ggparallel(list("Community", "Poverty"), data=summary.r, method="adj.angle")
# 
# ggparallel(names(summary.r)[c(3,4,2,1)], order=0, summary.r, weight="Freq") +
#   scale_fill_brewer(palette="Paired", guide="none") +
#   scale_colour_brewer(palette="Paired", guide="none")
# 
# library(iplots)
# summary.r = read.csv("Summary_results.csv", header=T)
# Pov.f = factor(summary.r$Poverty)
# Comm.f = factor(summary.r$Community)
# Pop.f = factor(summary.r$Population.composition)
# Hou.f = factor(summary.r$Housing.characteristics)
# 
# 
# imosaic(Comm.f,Pov.f,Pop.f,Hou.f) #mosaic plot
# ipcp(summary.r[c(1,2,3,4,5,6,7,8,9)])
# 
# library(vcd)
# 
# mosaic(fish.vul, shade=TRUE, legend=TRUE)
# 
# 
#       FAMILY   WORKFORCE  DIVERSE
# AGE.f = factor(fish.vul$AGE)
# RESIDENCE.f = factor(fish.vul$RESIDENCE)
# YRS_FISHING.f = factor(fish.vul$YRS_FISHING)
# OTHER_ACT = factor(fish.vul$OTHER_ACT)
# imosaic(AGE.f,RESIDENCE.f,YRS_FISHING.f,OTHER_ACT) #mosaic plot
